<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>LUNA的书店</title>
  <link rel="stylesheet" type="text/css" href="../css/front.css" charset="utf-8">
  <link rel="stylesheet" href="../css/iconfont.css">
</head>

<body>
<div id="header">
</div>
<div id="menu">
  <a href="#"><span class="iconfont icon-a-caozhiwu">首页</span> </a>
  <a href="#"><span class="iconfont icon-a-guoshushuzhiwu">专业</span></a>
  <a href="#"><span class="iconfont icon-a-huahuaduopenzaizhiwu">心理</span></a>
  <a href="#"><span class="iconfont icon-a-huahuaduozhiwu">商贸</span></a>
  <a href="#"><span class="iconfont icon-a-lvsedeshumuzhiwu">哲学</span></a>
  <a href="#"><span class="iconfont icon-a-shushumuzhiwu">小说</span></a>
  <a href="#"><span class="iconfont icon-a-xiangrikuihuahuaduozhiwu">社会</span></a>
  <a href="#"><span class="iconfont icon-a-meiguihuahuahuad uozhiwu">人文</span></a>
  <a href="#"><span class="iconfont icon-a-huahuaduopenzaizhiwu">后台</span></a>
  <a href="#"><span class="iconfont icon-a-caozhiwu">订单</span> </a>
</div>
<div id="main">
  <div class="sidebar" style="width:50%; margin-left: 24%;">
    <form style="align:center">
      <p style="font-size: 20px; margin-top: 50px;">用户注册</p>
      <p>用户名：<input type="text" name="username" type="text" id="username" value="请输入用户名"> <br>
        <span id="username_err" class="err_msg" style="display: none">用户名已存在</span></p>
      <p>密&nbsp;&nbsp;&nbsp;码：<input name="password" type="password" id="password">
       </span></p>
      <p>验证码：<input input name="checkCode" type="text" id="checkCode" style="width: 42px;">
        <img src="../image/a.jpg" style="width: 60px; height: 25px;">
        <a href="#"  style="font-size: 13px;">看不清？</a></p>
      <p><input type="submit"></a></p>
    </form>

    </form>
  </div>
</div>
<script>
  //1. 给用户名输入框绑定 失去焦点事件
  document.getElementById("username").onblur = function () {
    // 获取用户名的值
    var username = this.value;  //this ： 给谁绑定的事件，this就代表谁

    //2. 发送ajax请求
//2.1. 创建核心对象
    var xhttp;
    if (window.XMLHttpRequest) {
      xhttp = new XMLHttpRequest();
    } else {
      // code for IE6, IE5
      xhttp = new ActiveXObject("Microsoft.XMLHTTP");
    }
//2.2. 发送请求并携带参数
    xhttp.open("GET", "http://localhost:8081/JSPDemo/selectUserServlet?username=" + username);
    xhttp.send();

//2.3. 获取响应
    xhttp.onreadystatechange = function () {
      if (this.readyState == 4 && this.status == 200) {
        //处理响应的结果
        //判断
        if (this.responseText == "true") {
          //用户名存在，显示提示信息
          document.getElementById("username_err").style.display = '';
        } else {
          //用户名不存在 ，清楚提示信息
          document.getElementById("username_err").style.display = 'none';
        }
      }
    }
  }

</script>
</body>

</html>